<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PROGRAMACION EN LA NUBE/ GRUPO 3</title>

    <!-- Bootstrap CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Link a tu archivo CSS personalizado -->
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-dark text-white">
    <div class="container mt-5">
        <h1 class="text-center futuristic-header mb-5">PROGRAMACION EN LA NUBE / GRUPO 3</h1>

        <!-- Botones para acciones -->
        <div class="d-flex justify-content-center mb-4">
            <button id="fetch-data-btn" class="btn btn-primary me-3">Traer Información</button>
            <button id="clear-data-btn" class="btn btn-secondary">Limpiar Información</button>
        </div>

        <!-- Textarea para mostrar la información -->
        <div class="mb-4">
            <textarea id="data-container" class="form-control futuristic-textarea" rows="10" readonly></textarea>
        </div>

        <!-- Formulario para agregar cliente -->
        <h2 class="text-center futuristic-subheader mb-4">Agregar Nuevo Cliente</h2>
        <form id="cliente-form" class="mb-5">
            <div class="mb-3">
                <label for="id" class="form-label">ID:</label>
                <input type="text" id="id" name="id" class="form-control" required>
            </div>

            <div class="mb-3">
                <label for="nombre" class="form-label">Nombre:</label>
                <input type="text" id="nombre" name="nombre" class="form-control" required>
            </div>

            <div class="mb-3">
                <label for="correo" class="form-label">Correo:</label>
                <input type="email" id="correo" name="correo" class="form-control" required>
            </div>

            <div class="mb-3">
                <label for="telefono" class="form-label">Teléfono:</label>
                <input type="text" id="telefono" name="telefono" class="form-control" required>
            </div>

            <button type="submit" class="btn btn-success w-100">Agregar Cliente</button>
        </form>

        <!-- Formulario para modificar cliente -->
        <h2 class="text-center futuristic-subheader mb-4">Modificar Cliente</h2>
        <form id="modify-cliente-form">
            <div class="mb-3">
                <label for="modify-id" class="form-label">ID:</label>
                <input type="text" id="modify-id" name="modify-id" class="form-control" required>
            </div>

            <div class="mb-3">
                <label for="modify-nombre" class="form-label">Nombre:</label>
                <input type="text" id="modify-nombre" name="modify-nombre" class="form-control" required>
            </div>

            <div class="mb-3">
                <label for="modify-correo" class="form-label">Correo:</label>
                <input type="email" id="modify-correo" name="modify-correo" class="form-control" required>
            </div>

            <div class="mb-3">
                <label for="modify-telefono" class="form-label">Teléfono:</label>
                <input type="text" id="modify-telefono" name="modify-telefono" class="form-control" required>
            </div>

            <button type="submit" class="btn btn-warning w-100">Modificar Cliente</button>
        </form>
    </div>

    <script>
         function fetchData() {
            //fetch('http://localhost:3000/api/datos')
            fetch('https://banco-linea-27432012ae4f.herokuapp.com/api/datos')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log(data); // Maneja la información obtenida
                    const container = document.getElementById('data-container');
                    
                    // Limpiar la caja de texto antes de agregar nueva información
                    container.value = '';
                    
                    // Iterar sobre los resultados y mostrar en el textarea
                    data.forEach(row => {
                        container.value += `ID: ${row[0]}, Nombre: ${row[1]}, Correo: ${row[2]}, Teléfono: ${row[3]}\n`;
                    });
                })
                .catch(error => {
                    console.error('There has been a problem with your fetch operation:', error);
                });
        }

        document.getElementById('fetch-data-btn').addEventListener('click', fetchData);
        
        // Event listener for the clear button
        document.getElementById('clear-data-btn').addEventListener('click', function() {
            const container = document.getElementById('data-container');
            container.value = ''; // Clear the textarea
        }); 
        // Función para traer la información
        function fetchData() {
            fetch('https://banco-linea-27432012ae4f.herokuapp.com/api/datos')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log(data); // Maneja la información obtenida
                    const container = document.getElementById('data-container');
                    
                    // Limpiar la caja de texto antes de agregar nueva información
                    container.value = '';
                    
                    // Iterar sobre los resultados y mostrar en el textarea
                    data.forEach(row => {
                        container.value += `ID: ${row[0]}, Nombre: ${row[1]}, Correo: ${row[2]}, Teléfono: ${row[3]}\n`;
                    });
                })
                .catch(error => {
                    console.error('There has been a problem with your fetch operation:', error);
                });
        }

        document.getElementById('cliente-form').addEventListener('submit', function(event) {
            event.preventDefault(); // Evitar que el formulario se envíe de forma tradicional
        
            // Obtener los valores del formulario
            const id = document.getElementById('id').value; // Get ID value
            const nombre = document.getElementById('nombre').value;
            const correo = document.getElementById('correo').value;
            const telefono = document.getElementById('telefono').value;
        
            // Enviar los datos al backend
            fetch('http://localhost:3000/api/cliente', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    id: id, // Send ID
                    nombre: nombre,
                    correo: correo,
                    telefono: telefono
                })
            })
            .then(response => response.json())
            .then(data => {
                console.log('Cliente agregado:', data);
                alert('Cliente agregado exitosamente');
                fetchData(); // Traer la información actualizada
            })
            .catch(error => {
                console.error('Error al agregar el cliente:', error);
            });
        });

        //put 

        document.getElementById('modify-cliente-form').addEventListener('submit', function(event) {
    event.preventDefault(); // Prevent the form from submitting traditionally

    // Get the values from the modification form
    const id = document.getElementById('modify-id').value;
    const nombre = document.getElementById('modify-nombre').value;
    const correo = document.getElementById('modify-correo').value;
    const telefono = document.getElementById('modify-telefono').value;

    // Send the updated data to the backend
    fetch(`http://localhost:3000/api/cliente/${id}`, {
        method: 'PUT',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            nombre: nombre,
            correo: correo,
            telefono: telefono
        })
    })
    .then(response => response.json())
    .then(data => {
        console.log('Cliente modificado:', data);
        alert('Cliente modificado exitosamente');
        fetchData(); // Refresh the client list
    })
    .catch(error => {
        console.error('Error al modificar el cliente:', error);
    });
});
    </script>
</body>
</html>
